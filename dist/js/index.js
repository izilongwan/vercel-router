(()=>{"use strict";class t{constructor(t,s,e,i){this.first=i,this.pos=i?{x:t.x,y:t.y}:{x:t.nextPos.x,y:t.nextPos.y},this.l=s,this.ang=e,this.nextPos={x:this.pos.x+this.l*Math.cos(this.ang),y:this.pos.y+this.l*Math.sin(this.ang)}}update(t){this.ang=Math.atan2(t.y-this.pos.y,t.x-this.pos.x),this.pos.x=t.x+this.l*Math.cos(this.ang-Math.PI),this.pos.y=t.y+this.l*Math.sin(this.ang-Math.PI),this.nextPos.x=this.pos.x+this.l*Math.cos(this.ang),this.nextPos.y=this.pos.y+this.l*Math.sin(this.ang)}fallback(t){this.pos.x=t.x,this.pos.y=t.y,this.nextPos.x=this.pos.x+this.l*Math.cos(this.ang),this.nextPos.y=this.pos.y+this.l*Math.sin(this.ang)}show(t){t.lineTo(this.nextPos.x,this.nextPos.y)}}class s{constructor(s,e,i,h,n){this.x=s,this.y=e,this.l=i,this.n=h,this.t={},this.rand=Math.random(),this.segments=[new t(this,this.l/this.n,0,!0)];for(let s=1;s<this.n;s++)this.segments.push(new t(this.segments[s-1],this.l/this.n,0,!1))}move(t,s){this.angle=Math.atan2(s.y-this.y,s.x-this.x),this.dt=e(t.x,t.y,s.x,s.y)+5,this.t={x:s.x-.8*this.dt*Math.cos(this.angle),y:s.y-.8*this.dt*Math.sin(this.angle)},this.t.x?this.segments[this.n-1].update(this.t):this.segments[this.n-1].update(s);for(let t=this.n-2;t>=0;t--)this.segments[t].update(this.segments[t+1].pos);if(e(this.x,this.y,s.x,s.y)<=this.l+e(t.x,t.y,s.x,s.y)){this.segments[0].fallback({x:this.x,y:this.y});for(let t=1;t<this.n;t++)this.segments[t].fallback(this.segments[t-1].nextPos)}}show(t,s){if(e(this.x,this.y,s.x,s.y)<=this.l){t.globalCompositeOperation="color-dodge",t.beginPath(),t.lineTo(this.x,this.y);for(let s=0;s<this.n;s++)this.segments[s].show(t);t.strokeStyle="hsl("+(60*this.rand+180)+",100%,"+(60*this.rand+25)+"%)",t.lineWidth=2*this.rand,t.lineCap="round",t.lineJoin="round",t.stroke(),t.globalCompositeOperation="source-over"}}show2(t,s){t.beginPath(),e(this.x,this.y,s.x,s.y)<=this.l?(t.arc(this.x,this.y,2*this.rand+1,0,2*Math.PI),t.fillStyle="white"):(t.arc(this.x,this.y,2*this.rand,0,2*Math.PI),t.fillStyle="darkcyan"),t.fill()}}function e(t,s,e,i){return Math.sqrt(Math.pow(e-t,2)+Math.pow(i-s,2))}function i(t,s,e=null){return window.getComputedStyle?s?parseInt(window.getComputedStyle(t,e)[s]):window.getComputedStyle(t,null):s?parseInt(t.currentStyle[s]):t.currentStyle}new class{constructor(t=document.body){this.el=t,this.mouse={x:!1,y:!1},this.last_mouse={},this.maxl=300,this.minl=50,this.n=30,this.numt=500,this.tent=[],this.clicked=!1,this.target={x:0,y:0},this.last_target={},this.t=0,this.q=10,this.isOperate=!1,this.t=null,this.init()}init(){this.initCanvas(),this.genTentacle(),this.animate(),this.bindEvent()}bindEvent(){this.mouseEnterEvent=t=>this.onMouseEnter(t),this.mouseMoveEvent=t=>this.onMouseMove(t),this.mouseLeaveEvent=t=>this.onMouseLeave(t),this.el.addEventListener("click",(t=>this.handleOperate(t))),window.addEventListener("resize",function(t,s=500,e=!1){let i=null,h=null;function n(e){h=setTimeout((()=>{i=t.apply(this,e),a.onremove()}),s)}function a(...s){return h?(a.onremove(),n.call(this,s)):e?i=t.apply(this,s):n.call(this,s),i}return a.onremove=()=>{clearTimeout(h),h=null},a}(this.onResize.bind(this)),!1)}handleOperate(t){const{offsetX:s,offsetY:e}=t,{x:i,y:h}=this.target,n=Math.abs(s-i)<=30,a=Math.abs(e-h)<=30;n&&a&&(this.isOperate?this.onMouseLeave():this.onMouseEnter())}onMouseEnter(){document.addEventListener("mousemove",this.mouseMoveEvent,!1),this.el.addEventListener("mouseleave",this.mouseLeaveEvent,!1)}onMouseMove(t){const{offsetX:s,offsetY:e}=t;this.mouse.x=s,this.mouse.y=e,this.isOperate=!0}onMouseLeave(){clearTimeout(this.t),this.t=setTimeout((()=>{this.isOperate=!1,this.mouse.x=!1,this.mouse.y=!1,document.removeEventListener("mousemove",this.mouseMoveEvent,!1),this.el.removeEventListener("mouseleave",this.mouseLeaveEvent,!1)}),300)}onResize(){this.initCanvasSize(),this.tent=[],this.genTentacle()}animate(){const{canvas:t,ctx:s}=this,{width:e,height:i}=t;s.clearRect(0,0,e,i),this.show(),window.requestAnimationFrame((()=>this.animate()))}initCanvas(){const{el:t}=this;this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.canvas.style="\n      position: absolute;\n      top: 0;\n      left: 0;\n      z-index: -1;\n      background-color: #000;\n    ",this.initCanvasSize(),t.appendChild(this.canvas)}initCanvasSize(){const{el:t}=this;this.canvas.width=i(t,"width"),this.canvas.height=i(t,"height")}genTentacle(){const{canvas:t,maxl:e,minl:i,numt:h,n,tent:a}=this,{width:o,height:r}=t;for(let t=0;t<h;t++)a.push(new s(Math.random()*o,Math.random()*r,Math.random()*(e-i)+i,n,2*Math.random()*Math.PI))}show(){const{target:t,mouse:s,canvas:e,q:i,t:h}=this,{width:n,height:a}=e;s.x?(this.target.errx=s.x-t.x,this.target.erry=s.y-t.y):(this.target.errx=n/2+(a/2-i)*Math.sqrt(2)*Math.cos(h)/(Math.pow(Math.sin(h),2)+1)-this.target.x,this.target.erry=a/2+(a/2-i)*Math.sqrt(2)*Math.cos(h)*Math.sin(h)/(Math.pow(Math.sin(h),2)+1)-this.target.y),this.target.x+=this.target.errx/10,this.target.y+=this.target.erry/10,this.t+=.01,this.draw()}draw(){const{target:t,ctx:s,last_target:i,numt:h,tent:n}=this;s.beginPath(),s.arc(t.x,t.y,e(i.x,i.y,t.x,t.y)+5,0,2*Math.PI),s.fillStyle="hsl(210,100%,80%)",s.fill();for(let t=0;t<h;t++)n[t].move(i,this.target),n[t].show2(s,this.target);for(let t=0;t<h;t++)n[t].show(s,this.target);this.last_target.x=this.target.x,this.last_target.y=this.target.y}}})();